<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>new</title>
</head>
<body>
<script>
  function Super1(age) {
    this.age = age;
  }
  var instance1 = new Super1(27);
  var instance2 = new Super1(27);
  console.log(instance1);
  console.log(instance1.age);
  console.log(instance2.age);
  instance1.age = 26;
  console.log(instance1.age);
  console.log(instance2.age);

  console.log('---------------------')
</script>

<script>
  function Super2(age) {
    var obj = {a: 1};
    this.age = age;
    return obj;
  }
  var instance3 = new Super2(28);
  var instance4 = new Super2(28);
  console.log(instance3);
  console.log(instance3.age);
  console.log(instance3.a);
  console.log(instance4.a);
  instance4.a = 2;
  console.log(instance3.a);
  console.log(instance4.a);

  console.log('---------------------')
</script>

<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/new" target="_blank">MDN new</a>
<script>
// 1. 创建一个空对象 创建一个空的简单JavaScript对象（即{}）；
// 2. 空对象的原型指向构造函数的原型 链接该对象（即设置该对象的构造函数）到另一个对象；
// 3. this 执行上下文 将步骤1新创建的对象作为this的上下文；
// 4. 如果该函数没有返回对象，则返回this。
function MyNew() {
  var obj = {}
  obj.__proto__ = Object.create(MyNew)

  return obj
}
/**
 * 当代码 new Foo(...) 执行时，会发生以下事情：
 * 1. 一个继承自 Foo.prototype 的新对象被创建。
 * 2. 使用指定的参数调用构造函数 Foo，并将 this 绑定到新创建的对象。new Foo 等同于 new Foo()，也就是没有指定参数列表，Foo 不带任何参数调用的情况。
 * 3. 由构造函数返回的对象就是 new 表达式的结果。如果构造函数没有显式返回一个对象，则使用步骤1创建的对象。（一般情况下，构造函数不返回值，但是用户可以选择主动返回对象，来覆盖正常的对象创建步骤）
 */
</script>

<script>
// 运算符优先级 https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Operator_Precedence
/**
 * 20 圆括号 ()
 * 19 成员访问 .
 *    需计算的成员访问 []
 *    new (带参数列表)
 *    函数调用
 * 18 new (无参数列表)
 */
function Foo() {
  return this;
}
Foo.getName = function(a) {
  console.log('1', a);
}
Foo.prototype.getName = function(a) {
  console.log('2', a);
}
new Foo.getName;            // 1 undefined  |  new (Foo.getName)
new Foo.getName();          // 1 undefined  |  new (Foo.getName)()
new Foo.getName('hello');   // 1 hello
new Foo().getName();        // 2 undefined  |  (new Foo()).getName()
new Foo().getName('world'); // 2 world      |  (new Foo()).getName()
</script>
</body>
</html>